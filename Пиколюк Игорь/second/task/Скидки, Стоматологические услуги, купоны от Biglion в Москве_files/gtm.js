var bgln=bgln||{};bgln.gtm=webpackJsonpbgln__name_([35],{406:function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var o=i(29),r=n(o),d=i(30),a=n(d),s=i(135),l=n(s),c=i(13),u=n(c),f="function"==typeof a.default&&"symbol"==typeof r.default?function(t){return typeof t}:function(t){return t&&"function"==typeof a.default&&t.constructor===a.default&&t!==a.default.prototype?"symbol":typeof t},h={init:function(){var t=this;window.removeEventListener("load",h.init,!1);var e=1,i=1,n="",o=window.pageYOffset;this.hidden=[],this.visibleOnLoad=[],this.viewState={},this.sendViewedProducts=this.sendViewedProducts.bind(this);var r=!0,d=!1,a=void 0;try{for(var s,l=(0,u.default)(document.querySelectorAll(".ec_track_item"));!(r=(s=l.next()).done);r=!0){var c=s.value;!function(r){var d=e++,a=r.dataset.do_id,s=r.closest(".ec_container"),l="",c="object"===f(window.do_list)&&window.do_list[a]?window.do_list[a]:{};s&&(n!==s?(n=s,i=1):i++,d=i,l=s.dataset.list);var u={position:d,list:l||t.createListName(r),id:a,price:c.price||"нет данных",category:c.category||"нет данных",name:r.dataset.do_title_link};t.sortViewState({fromTop:o,el:r,info:u}),r.addEventListener("click",function(){t.onProductClick(u)},!1)}(c)}}catch(t){d=!0,a=t}finally{try{!r&&l.return&&l.return()}finally{if(d)throw a}}this.visibleOnLoad.length&&this.onProductView(this.visibleOnLoad),this.visibleOnLoad=null,window.addEventListener("scroll",this.sendViewedProducts,!1)},sortViewState:function(t){var e=t.el;if(!e.offsetParent)return this.hidden.push({el:e,data:t.info}),!1;var i=e.getBoundingClientRect(),n=(t.fromTop+i.top+i.height/2).toFixed(0);if(this.visibleOnLoad&&n>=t.fromTop&&n<=t.fromTop+window.innerHeight)return this.visibleOnLoad.push(t.info),!1;this.viewState[n]?this.viewState[n].push(t.info):this.viewState[n]=[t.info]},sendViewedProducts:function(){var t=this,e=window.pageYOffset,i=e+window.innerHeight;this.hidden.length||(0,l.default)(this.viewState).length||window.removeEventListener("scroll",this.sendViewedProducts,!1),this.hidden&&function(){var i=t.hidden.slice();t.hidden=[];var n=!0,o=!1,r=void 0;try{for(var d,a=(0,u.default)(i);!(n=(d=a.next()).done);n=!0){var s=d.value;t.sortViewState({fromTop:e,el:s.el,info:s.data})}}catch(t){o=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(o)throw r}}}();for(var n in this.viewState)+n>=e&&+n<=i&&(this.onProductView(this.viewState[n]),delete this.viewState[n])},onProductView:function(t){dataLayer.push({event:"productView",ecommerce:{currencyCode:"RUB",impressions:t}})},onProductClick:function(t){var e=t.list;delete t.list,dataLayer.push({event:"productClick",ecommerce:{click:{actionField:{list:e},products:[t]}}}),window.localStorage.setItem("listData",e)},createListName:function(){var t=document.querySelector(".breadcrumbs"),e=document.location.pathname;return"/"===e?"Главная":"/deals/"===e?"Все акции":t?t.innerText.replace(/\s*\/+\s*/gi,"/").split("/").pop():document.title}};window.addEventListener("load",h.init.bind(h),!1)}},[406]);